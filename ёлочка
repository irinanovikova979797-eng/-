using System;
using System.Threading;

class Program
{
    static void Main()
    {
        Console.CursorVisible = false;

        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∫–æ–Ω—Å–æ–ª–∏ –¥–ª—è –±–æ–ª—å—à–µ–π —ë–ª–∫–∏
        Console.WindowWidth = 120;
        Console.WindowHeight = 40;

        for (int frame = 0; frame < 50; frame++)
        {
            Console.Clear();
            DrawTree(frame);
            Thread.Sleep(300);
        }

        Console.CursorVisible = true;
    }

    static void DrawTree(int frame)
    {
        Random random = new Random();
        int height = 20;
        int consoleWidth = Console.WindowWidth;

        // –ú–µ—Ä—Ü–∞—é—â–∞—è –∑–≤–µ–∑–¥–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É
        if (frame % 2 == 0)
            Console.ForegroundColor = ConsoleColor.Yellow;
        else
            Console.ForegroundColor = ConsoleColor.White;

        string star = "‚òÖ";
        int starPosition = (consoleWidth - 1) / 2; // –¶–µ–Ω—Ç—Ä –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
        Console.SetCursorPosition(starPosition, 0);
        Console.WriteLine(star);

        // –í–µ—Ç–≤–∏ —Å –º–∏–≥–∞—é—â–∏–º–∏ –æ–≥–æ–Ω—å–∫–∞–º–∏
        for (int i = 0; i < height; i++)
        {
            int width = 2 * i + 1;

            // –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
            int leftPadding = (consoleWidth - width) / 2;

            Console.SetCursorPosition(leftPadding, i + 1);

            for (int j = 0; j < width; j++)
            {
                if (random.Next(10) < 3 && frame % 2 == 0)
                {
                    Console.ForegroundColor = GetRandomColor(random);
                    Console.Write("o");
                }
                else
                {
                    Console.ForegroundColor = ConsoleColor.Green;
                    Console.Write("*");
                }
            }
        }

        // –°—Ç–≤–æ–ª –ø–æ —Ü–µ–Ω—Ç—Ä—É
        Console.ForegroundColor = ConsoleColor.DarkYellow;
        int trunkWidth = 3;
        int trunkPosition = (consoleWidth - trunkWidth) / 2;
        Console.SetCursorPosition(trunkPosition, height + 1);
        Console.WriteLine("|||");
        Console.SetCursorPosition(trunkPosition, height + 2);
        Console.WriteLine("---");

        // –ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ —Ü–µ–Ω—Ç—Ä—É
        Console.ResetColor();
        string greeting = "–° –ù–æ–≤—ã–º –ì–æ–¥–æ–º! üéÑ";
        int greetingPosition = (consoleWidth - greeting.Length) / 2;
        Console.SetCursorPosition(greetingPosition, height + 4);
        Console.WriteLine(greeting);

        // –î–æ–±–∞–≤–ª—è–µ–º —Å–Ω–µ–≥
        DrawSnow(random, height, consoleWidth);
    }

    static void DrawSnow(Random random, int treeHeight, int consoleWidth)
    {
        Console.ForegroundColor = ConsoleColor.White;
        int consoleHeight = Console.WindowHeight;

        // –†–∏—Å—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —Å–Ω–µ–∂–∏–Ω–∫–∏ –≤–æ–∫—Ä—É–≥ —ë–ª–∫–∏
        for (int i = 0; i < 30; i++)
        {
            int x = random.Next(consoleWidth);
            int y = random.Next(consoleHeight - 5);

            // –ù–µ —Ä–∏—Å—É–µ–º —Å–Ω–µ–≥ –Ω–∞ —Å–∞–º–æ–π —ë–ª–∫–µ
            if (!IsPositionOnTree(x, y, treeHeight, consoleWidth))
            {
                Console.SetCursorPosition(x, y);
                Console.Write("‚Ä¢");
            }
        }
    }

    static bool IsPositionOnTree(int x, int y, int height, int consoleWidth)
    {
        if (y <= 0 || y > height + 1) return false;

        int center = consoleWidth / 2;

        if (y == 0)
        {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –∑–≤–µ–∑–¥—ã
            return x == center;
        }

        int row = y - 1;
        if (row < 0 || row >= height) return false;

        int treeWidthAtRow = 2 * row + 1;
        int treeLeft = center - treeWidthAtRow / 2;
        int treeRight = treeLeft + treeWidthAtRow - 1;

        return x >= treeLeft && x <= treeRight;
    }

    static ConsoleColor GetRandomColor(Random random)
    {
        ConsoleColor[] colors = {
            ConsoleColor.Red,
            ConsoleColor.Blue,
            ConsoleColor.Cyan,
            ConsoleColor.Magenta,
            ConsoleColor.Yellow,
            ConsoleColor.White
        };
        return colors[random.Next(colors.Length)];
    }
}
